import matplotlib.pyplot as plt
import numpy as np
import os

Ex1=[8.16316222807115e-11,
8.20664234335118e-11,
8.25606655545402e-11,
8.31244614162638e-11,
8.37688817461822e-11,
8.45070637369622e-11,
8.53546204134787e-11,
8.63148696869176e-11,
8.72681598869603e-11,
8.73445403776375e-11,
8.23039177929021e-11,
5.63701489523372e-11,
-3.71565049209197e-11,
-3.11159138705887e-10,
-9.92915533237233e-10,
-2.46953769510063e-09,
-5.30507841740861e-09,
-1.02065178003932e-08,
-1.79333561090731e-08,
-2.91692419024371e-08,
-4.43908253471162e-08,
-6.37704802834146e-08,
-8.71366535908050e-08,
-1.13996209159061e-07,
-1.43606088941501e-07,
-1.75072279268899e-07,
-2.07453179838405e-07,
-2.39849560267178e-07,
-2.71470882080980e-07,
-3.01675004820405e-07,
-3.29983593801233e-07,
-3.56078491330674e-07,
-3.79785242506062e-07,
-4.01049531064253e-07,
-4.19911131712263e-07,
-4.36478623286551e-07,
-4.50906844166068e-07,
-4.63378058437364e-07,
-4.74087077097362e-07,
-4.83230117405374e-07,
-4.90996931390950e-07,
-4.97565632137479e-07,
-5.03099641162236e-07,
-5.07746230814589e-07,
-5.11636212783882e-07,
-5.14884408400145e-07,
-5.17590617098047e-07,
-5.19840870388849e-07,
-5.21708817741321e-07,
-5.23257137868462e-07,
-5.24538905167976e-07,
-5.25598868089957e-07,
-5.26474615731823e-07,
-5.27197622605075e-07,
-5.27794170685609e-07,
-5.28286153710187e-07,
-5.28691772140455e-07,
-5.29026128997078e-07,
-5.29301737408480e-07,
-5.29528950617281e-07,
-5.29716324628147e-07,
-5.29870922863390e-07,
-5.29998571254383e-07,
-5.30104071228196e-07,
-5.30191377107167e-07,
-5.30263743558420e-07,
-5.30323847928460e-07,
-5.30373891582153e-07,
-5.30415683735945e-07,
-5.30450710727987e-07,
-5.30480193196721e-07,
-5.30505133236835e-07,
-5.30526353259498e-07,
-5.30544527994888e-07,
-5.30560210831883e-07,
-5.30573855486033e-07,
-5.30585833816624e-07,
-5.30596450471723e-07,
-5.30605954921998e-07,
-5.30614551346190e-07,
-5.30622406749858e-07,
-5.30629657631858e-07,
-5.30636415457470e-07,
-5.30642771151248e-07,
-5.30648798784835e-07,
-5.30654558603835e-07,
-5.30660099512128e-07,
-5.30665461110935e-07,
-5.30670675372489e-07,
-5.30675768013933e-07,
-5.30680759625280e-07,
-5.30685666595618e-07,
-5.30690501873824e-07,
-5.30695275593529e-07,
-5.30699995586733e-07,
-5.30704667806059e-07,
-5.30709296672087e-07,
-5.30713885359165e-07,
-5.30718436030781e-07,
-5.30722950033474e-07]

THIS_FOLDER = os.path.dirname(os.path.abspath(__file__))
data1=np.load(os.path.join(THIS_FOLDER,'recip1_bg_eta08_box_eta03_200-200.npy'))
data2=np.load(os.path.join(THIS_FOLDER,'recip2_bg_eta08_box_eta03_200-200.npy'))
# print(data1[0],data2[0])
time=np.logspace(np.log10(2e-5),np.log10(10),100)

# plt.semilogx(time,abs(np.asarray(Ex1)-np.asarray(Ex1[-1])),label='first position (W&H 2.40)')
# plt.semilogx(time,abs(np.asarray(Ex1)-np.asarray(Ex1[-1])),label='second position (W&H 2.40)')
plt.semilogx(time,abs(data1[0]-data1[0][-1]),label='first position')
plt.semilogx(time,abs(data2[0]-data2[0][-1]),label='second position')
plt.ylabel(r'$E_x (v/m)$')
plt.xlabel('Time (s)')
plt.annotate(r'BG $\sigma=0.8$ S/m $\eta=0.8$ $\tau=0.5$ $c=0.25$', xy=(0.05, 0.60), xycoords='axes fraction', backgroundcolor='w', fontsize=9)
plt.annotate(r'Box $\sigma=0.1$ S/m $\eta=0.3$ $\tau=0.5$ $c=0.25$', xy=(0.05, 0.69), xycoords='axes fraction', backgroundcolor='w', fontsize=9)
plt.title('SimPEG WS (TX-RX away from target)')
plt.grid()
plt.legend()
plt.show()